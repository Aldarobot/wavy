<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web Audio Example</title>
  <meta name="description" content="Audio basics demo for Web Audio API">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
  <script type="text/javascript">
    // Construct an AudioContext
    let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    // 
    console.info('Sample Rate: ' + audioCtx.sampleRate);
    // Short buffer
    var output_buffer = audioCtx.createBuffer(2, 1024, audioCtx.sampleRate);
    // Fill buffer
    for (var channel = 0; channel < output_buffer.numberOfChannels; channel++) {
      // This gives us the actual ArrayBuffer that contains the data
      var nowBuffering = output_buffer.getChannelData(channel);
      for (var i = 0; i < output_buffer.length; i++) {
        // Math.random() is in [0; 1.0]
        // audio needs to be in [-1.0; 1.0]
        nowBuffering[i] = ((i % 128) / 128) * 2 - 1;
      }
    }
    // 
    var size = 1024.0 / audioCtx.sampleRate;
    var next_a = audioCtx.currentTime;
    var next_b = next_a + size;

    function play_a() {
        next_a += size * 2.0;
        var a_source = audioCtx.createBufferSource();
        a_source.onended = play_a;
        a_source.buffer = output_buffer;
        a_source.connect(audioCtx.destination);
        a_source.start(next_a);
    }
    
    function play_b() {
        next_b += size * 2.0;
        var b_source = audioCtx.createBufferSource();
        b_source.onended = play_b;
        b_source.buffer = output_buffer;
        b_source.connect(audioCtx.destination);
        b_source.start(next_b);
    }

    var a_source = audioCtx.createBufferSource();
    a_source.onended = play_a;
    a_source.buffer = output_buffer;
    a_source.connect(audioCtx.destination);
    a_source.start(next_a);
    var b_source = audioCtx.createBufferSource();
    b_source.onended = play_b;
    b_source.buffer = output_buffer;
    b_source.connect(audioCtx.destination);
    b_source.start(next_b);
  </script>
</body>
